<html>
	<head>
		<title>WebSocket Test</title>
		<script type="text/javascript">
			function ohno(err)
			{
				console.log(err.toString());
			}	

			function main()
			{
				var con = new WebSocket("ws://localhost:7681", "ws");
				con.onopen = function() {console.log("open sesame")}
				con.onclose = function() {console.log("close sesame")}
				con.onerror = ohno;
				con.onmessage = function(e) {
					var msg = e.data;
					console.log("Got message!");
					document.getElementById("main").innerHTML += "<p>"+msg+"</p>";
					setTimeout(function() {con.send("Hello\nWorld\n")}, 1000);
				}
				
			}	
	</script>
	</head>

<body onload="main()">
	<div id="main"></div>
</body>

</html>
